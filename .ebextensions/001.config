container_commands:
  01_directory:
    command: mkdir cache
  02_chown:
    chown -R webapp:webapp cache
  03_schema:
    command: php vendor/bin/doctrine orm:schema-tool:create
# Fixing permissions of vendor
files:
  "/opt/elasticbeanstalk/hooks/appdeploy/pre/10_fixing_permission.sh":
    content: |
        #!/usr/bin/env bash
 
        # . /opt/elasticbeanstalk/containerfiles/envvars
        . /opt/elasticbeanstalk/support/envvars
 
        VENDOR_DIR=$EB_CONFIG_APP_ONDECK/vendor
 
        if [ -d $VENDOR_DIR ]
        then
          chown -R webapp:webapp $VENDOR_DIR
          echo "Modified the owner of $VENDOR_DIR files"
        else
          echo "Nothing in $VENDOR_DIR"
        fi
 
        true
    mode: "000755"